<% @nagios_hostgroups = [ ] -%>
<% @nd.each_pair do |k, v| -%>
<% @nagios_hostgroups << v['domain'] -%>
<% end -%>
# autogenerated by puppet. do not touch
<% @nagios_hostgroups.uniq.each do  |x| -%>
<% @vhosts = [ ] -%>
<% @nd.each_pair do |k, v| -%>
<% if (v['domain'] || "") == x -%>
<% @vhosts << k -%>
<% end -%>
<% end -%>
<% if @vhosts.length > 0 -%>
define hostgroup {
      hostgroup_name <%= x %>
      members <%= @vhosts.join(',') %>
}
<% end -%>
<% end -%>
